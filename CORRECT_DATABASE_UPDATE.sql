-- تحديث قاعدة البيانات الموجودة بدلاً من إنشاء جديدة
USE health_staff_management;

-- تعطيل فحص المفاتيح الخارجية مؤقتاً
SET FOREIGN_KEY_CHECKS = 0;

-- حذف البيانات الموجودة أولاً
DELETE FROM users;
DELETE FROM centers;
DELETE FROM hospitals;
DELETE FROM roles;

-- إعادة تعيين AUTO_INCREMENT
ALTER TABLE users AUTO_INCREMENT = 1;
ALTER TABLE centers AUTO_INCREMENT = 1;
ALTER TABLE hospitals AUTO_INCREMENT = 1;
ALTER TABLE roles AUTO_INCREMENT = 1;

-- إدراج المستشفيات الصحيحة
INSERT INTO hospitals (id, name, code, address, phone, email, manager_name) VALUES
(1, 'مجمع الملك عبد الله الطبي', 'KAMC', 'مكة المكرمة، المملكة العربية السعودية', '0123456789', 'info@kamc.med.sa', 'د. أحمد محمد'),
(2, 'مستشفى رابغ', 'RH', 'رابغ، المملكة العربية السعودية', '0123456790', 'info@rh.med.sa', 'د. فاطمة أحمد'),
(3, 'مستشفى الملك فهد', 'KFH', 'الرياض، المملكة العربية السعودية', '0123456791', 'info@kfh.med.sa', 'د. محمد عبدالله');

-- إدراج المراكز الصحيحة (38 مركز)
INSERT INTO centers (id, hospital_id, name, code, description, manager_name, phone, email, is_active) VALUES
-- مجمع الملك عبد الله الطبي (13 مركز)
(1, 1, 'مركز الشراع 505', 'KAMC_SHARAA_505', 'مركز الشراع 505 التابع لمجمع الملك عبد الله الطبي', 'د. سارة محمد', '0112345679', 'sharaa505@kamc.med.sa', 1),
(2, 1, 'مركز ابحر الشمالية', 'KAMC_ABHAR_NORTH', 'مركز ابحر الشمالية التابع لمجمع الملك عبد الله الطبي', 'د. خالد أحمد', '0112345680', 'abhar@kamc.med.sa', 1),
(3, 1, 'مركز الريان', 'KAMC_ALRAYYAN', 'مركز الريان التابع لمجمع الملك عبد الله الطبي', 'د. نورا عبدالله', '0112345681', 'rayan@kamc.med.sa', 1),
(4, 1, 'مركز الصالحية', 'KAMC_ALSALIHIYAH', 'مركز الصالحية التابع لمجمع الملك عبد الله الطبي', 'د. عمر محمد', '0112345682', 'salahiya@kamc.med.sa', 1),
(5, 1, 'مركز الصواري', 'KAMC_ALSAWARI', 'مركز الصواري التابع لمجمع الملك عبد الله الطبي', 'د. لينا أحمد', '0112345683', 'sawari@kamc.med.sa', 1),
(6, 1, 'مركز الفردوس', 'KAMC_ALFERDOUS', 'مركز الفردوس التابع لمجمع الملك عبد الله الطبي', 'د. يوسف حسن', '0112345684', 'fardous@kamc.med.sa', 1),
(7, 1, 'مركز الماجد', 'KAMC_ALMAJED', 'مركز الماجد التابع لمجمع الملك عبد الله الطبي', 'د. هدى علي', '0112345685', 'majed@kamc.med.sa', 1),
(8, 1, 'مركز الوفاء', 'KAMC_ALWAFA', 'مركز الوفاء التابع لمجمع الملك عبد الله الطبي', 'د. عبدالرحمن سعد', '0112345686', 'wafa@kamc.med.sa', 1),
(9, 1, 'مركز بريمان', 'KAMC_BURAIMAN', 'مركز بريمان التابع لمجمع الملك عبد الله الطبي', 'د. مريم حسن', '0112345687', 'buraiman@kamc.med.sa', 1),
(10, 1, 'مركز ثول', 'KAMC_THUWAL', 'مركز ثول التابع لمجمع الملك عبد الله الطبي', 'د. عبدالله سعد', '0112345688', 'thuwal@kamc.med.sa', 1),
(11, 1, 'مركز خالد النموذجي', 'KAMC_KHALID_MODEL', 'مركز خالد النموذجي التابع لمجمع الملك عبد الله الطبي', 'د. فاطمة محمد', '0112345689', 'khalid@kamc.med.sa', 1),
(12, 1, 'مركز ذهبان', 'KAMC_DHAHBAN', 'مركز ذهبان التابع لمجمع الملك عبد الله الطبي', 'د. أحمد يوسف', '0112345690', 'dhahban@kamc.med.sa', 1),
(13, 1, 'مركز مشرفة', 'KAMC_MUSHARRAF', 'مركز مشرفة التابع لمجمع الملك عبد الله الطبي', 'د. نور الدين', '0112345691', 'musharraf@kamc.med.sa', 1),

-- مستشفى رابغ (13 مركز)
(14, 2, 'مركز الابواء', 'RH_ALABWA', 'مركز الابواء التابع لمستشفى رابغ', 'د. يوسف محمد', '0123456790', 'abwa@rh.med.sa', 1),
(15, 2, 'مركز الجحفة', 'RH_ALJAHFA', 'مركز الجحفة التابع لمستشفى رابغ', 'د. هدى أحمد', '0123456791', 'jahfa@rh.med.sa', 1),
(16, 2, 'مركز الجوبة', 'RH_ALJOUBA', 'مركز الجوبة التابع لمستشفى رابغ', 'د. عبدالرحمن علي', '0123456792', 'jouba@rh.med.sa', 1),
(17, 2, 'مركز الصليب الشرقي', 'RH_ALSALEEB_EAST', 'مركز الصليب الشرقي التابع لمستشفى رابغ', 'د. سارة حسن', '0123456793', 'saleeb@rh.med.sa', 1),
(18, 2, 'مركز المرجانية', 'RH_ALMARJANIYAH', 'مركز المرجانية التابع لمستشفى رابغ', 'د. محمد عبدالله', '0123456794', 'marjaniya@rh.med.sa', 1),
(19, 2, 'مركز المرخة', 'RH_ALMARKHA', 'مركز المرخة التابع لمستشفى رابغ', 'د. فاطمة يوسف', '0123456795', 'markha@rh.med.sa', 1),
(20, 2, 'مركز النويبع', 'RH_ALNUWAYBA', 'مركز النويبع التابع لمستشفى رابغ', 'د. خالد أحمد', '0123456796', 'nuwayba@rh.med.sa', 1),
(21, 2, 'مركز حجر', 'RH_HAJAR', 'مركز حجر التابع لمستشفى رابغ', 'د. نورا محمد', '0123456797', 'hajar@rh.med.sa', 1),
(22, 2, 'مركز رابغ', 'RH_RABIGH', 'مركز رابغ التابع لمستشفى رابغ', 'د. عمر حسن', '0123456798', 'rabigh@rh.med.sa', 1),
(23, 2, 'مركز صعبر', 'RH_SAABAR', 'مركز صعبر التابع لمستشفى رابغ', 'د. لينا سعد', '0123456799', 'saabar@rh.med.sa', 1),
(24, 2, 'مركز كلية', 'RH_KULAYYAH', 'مركز كلية التابع لمستشفى رابغ', 'د. عبدالله علي', '0123456800', 'kulayyah@rh.med.sa', 1),
(25, 2, 'مركز مستورة', 'RH_MASTURAH', 'مركز مستورة التابع لمستشفى رابغ', 'د. مريم يوسف', '0123456801', 'masturah@rh.med.sa', 1),
(26, 2, 'مركز مغينية', 'RH_MUGHINIYAH', 'مركز مغينية التابع لمستشفى رابغ', 'د. أحمد نور', '0123456802', 'mughiniyah@rh.med.sa', 1),

-- مستشفى الملك فهد (12 مركز)
(27, 3, 'مركز البوادي 2', 'KFH_BAWADI_2', 'مركز البوادي 2 التابع لمستشفى الملك فهد', 'د. مريم حسن', '0119876544', 'bawadi2@kfh.med.sa', 1),
(28, 3, 'مركز البوادي 1', 'KFH_BAWADI_1', 'مركز البوادي 1 التابع لمستشفى الملك فهد', 'د. عبدالله سعد', '0119876545', 'bawadi1@kfh.med.sa', 1),
(29, 3, 'مركز الربوة', 'KFH_ALRABWA', 'مركز الربوة التابع لمستشفى الملك فهد', 'د. فاطمة أحمد', '0119876546', 'rabwa@kfh.med.sa', 1),
(30, 3, 'مركز الرحاب', 'KFH_ALREHAB', 'مركز الرحاب التابع لمستشفى الملك فهد', 'د. يوسف محمد', '0119876547', 'rehab@kfh.med.sa', 1),
(31, 3, 'مركز السلامة', 'KFH_ALSALAMAH', 'مركز السلامة التابع لمستشفى الملك فهد', 'د. نورا عبدالله', '0119876548', 'salamah@kfh.med.sa', 1),
(32, 3, 'مركز الشاطئ', 'KFH_ALSHATIE', 'مركز الشاطئ التابع لمستشفى الملك فهد', 'د. خالد حسن', '0119876549', 'shatie@kfh.med.sa', 1),
(33, 3, 'مركز الصفا 1', 'KFH_ALSAFA_1', 'مركز الصفا 1 التابع لمستشفى الملك فهد', 'د. سارة علي', '0119876550', 'safa1@kfh.med.sa', 1),
(34, 3, 'مركز الصفا 2', 'KFH_ALSAFA_2', 'مركز الصفا 2 التابع لمستشفى الملك فهد', 'د. عمر يوسف', '0119876551', 'safa2@kfh.med.sa', 1),
(35, 3, 'مركز الفيصلية', 'KFH_ALFAISALIYAH', 'مركز الفيصلية التابع لمستشفى الملك فهد', 'د. هدى محمد', '0119876552', 'faisaliyah@kfh.med.sa', 1),
(36, 3, 'مركز المروة', 'KFH_ALMARWAH', 'مركز المروة التابع لمستشفى الملك فهد', 'د. عبدالرحمن سعد', '0119876553', 'marwah@kfh.med.sa', 1),
(37, 3, 'مركز النعيم', 'KFH_ALNAEEM', 'مركز النعيم التابع لمستشفى الملك فهد', 'د. لينا أحمد', '0119876554', 'naeem@kfh.med.sa', 1),
(38, 3, 'مركز النهضة', 'KFH_ALNAHDAH', 'مركز النهضة التابع لمستشفى الملك فهد', 'د. محمد نور', '0119876555', 'nahdah@kfh.med.sa', 1);

-- إدراج الأدوار الصحيحة
INSERT INTO roles (id, name, display_name, description, permissions, is_active) VALUES
(1, 'super_admin', 'مدير عام على كل المراكز', 'مدير عام له صلاحية كاملة على جميع المراكز والمستشفيات', '{"all": true}', 1),
(2, 'hospital_manager', 'مدير المراكز', 'مدير المستشفى المشرف على المراكز التابعة له فقط', '{"hospital_centers": true, "reports": true, "approve": true}', 1),
(3, 'center_manager', 'مدير مركز', 'مدير مركز واحد فقط، لا يرى مراكز أخرى', '{"center_only": true, "approve": true, "reports": true}', 1),
(4, 'data_entry', 'مدخل بيانات', 'مدخل بيانات لمركز واحد فقط، يحتاج موافقة المدير', '{"data_entry": true, "center_only": true}', 1);

-- إعادة تمكين فحص المفاتيح الخارجية
SET FOREIGN_KEY_CHECKS = 1;
