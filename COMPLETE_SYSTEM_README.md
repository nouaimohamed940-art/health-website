# نظام إدارة القوى العاملة الصحية - النظام الكامل

## نظرة عامة
نظام شامل لإدارة القوى العاملة الصحية يتضمن 38 مركز موزعة على 3 مستشفيات مع نظام صلاحيات متدرج.

## الهيكل التنظيمي

### المستشفيات (3 مستشفيات)
1. **مجمع الملك عبد الله الطبي** - 13 مركز
2. **مستشفى رابغ** - 13 مركز  
3. **مستشفى الملك فهد** - 12 مركز

### المراكز (38 مركز)

#### مجمع الملك عبد الله الطبي (13 مركز)
- مركز الشراع 505
- مركز ابحر الشمالية
- مركز الريان
- مركز الصالحية
- مركز الصواري
- مركز الفردوس
- مركز الماجد
- مركز الوفاء
- مركز بريمان
- مركز ثول
- مركز خالد النموذجي
- مركز ذهبان
- مركز مشرفة

#### مستشفى رابغ (13 مركز)
- مركز الابواء
- مركز الجحفة
- مركز الجوبة
- مركز الصليب الشرقي
- مركز المرجانية
- مركز المرخة
- مركز النويبع
- مركز حجر
- مركز رابغ
- مركز صعبر
- مركز كلية
- مركز مستورة
- مركز مغينية

#### مستشفى الملك فهد (12 مركز)
- مركز البوادي 2
- مركز البوادي 1
- مركز الربوة
- مركز الرحاب
- مركز السلامة
- مركز الشاطئ
- مركز الصفا 1
- مركز الصفا 2
- مركز الفيصلية
- مركز المروة
- مركز النعيم
- مركز النهضة

## المستخدمون والحسابات

### السوبر يوزر (3 حسابات)
- **super_admin_1** - السوبر يوزر الأول
- **super_admin_2** - السوبر يوزر الثاني
- **super_admin_3** - السوبر يوزر الثالث

**الصلاحيات:** وصول كامل لجميع المراكز والمستشفيات

### مديري المستشفيات (3 حسابات)
- **hospital_manager_kamc** - مدير مجمع الملك عبد الله الطبي
- **hospital_manager_rh** - مدير مستشفى رابغ
- **hospital_manager_kfh** - مدير مستشفى الملك فهد

**الصلاحيات:** إدارة المراكز التابعة لمستشفاهم فقط

### مديري المراكز (38 حساب)
حساب واحد لكل مركز من الـ 38 مركز

**الصلاحيات:** إدارة مركز واحد فقط، لا يمكن رؤية مراكز أخرى

### مدخلي البيانات (76 حساب)
حسابين لكل مركز (2 × 38 = 76 حساب)

**الصلاحيات:** إدخال البيانات لمركز واحد فقط، تحتاج موافقة مدير المركز

## كلمات المرور
جميع الحسابات تستخدم كلمة المرور: **password**

## كيفية التثبيت

### 1. إعداد قاعدة البيانات
```sql
-- تشغيل الملفات بالترتيب:
1. FINAL_COMPLETE_SYSTEM.sql
2. FINAL_CENTER_MANAGERS.sql
3. data_entry_users.sql (من الملفات السابقة)
```

### 2. إعداد الملفات
- تأكد من تحديث `config/config.php` لاستخدام المنفذ الصحيح (3307)
- تأكد من تحديث `config/database.php` لاستخدام اسم قاعدة البيانات الصحيح

### 3. اختبار النظام
1. افتح `http://localhost/mostaqil/login.php`
2. جرب الحسابات التجريبية المختلفة
3. تأكد من التوجيه الصحيح لكل دور

## الصلاحيات التفصيلية

### السوبر يوزر
- ✅ عرض جميع المراكز والمستشفيات
- ✅ إدارة جميع المستخدمين
- ✅ عرض جميع التقارير
- ✅ إعدادات النظام

### مدير المستشفى
- ✅ عرض مراكز مستشفاه فقط
- ✅ إدارة مديري المراكز التابعة له
- ✅ عرض تقارير مستشفاه
- ❌ لا يمكن رؤية مراكز مستشفيات أخرى

### مدير المركز
- ✅ عرض بيانات مركزه فقط
- ✅ إدارة مدخلي البيانات في مركزه
- ✅ الموافقة على البيانات المدخلة
- ✅ عرض تقارير مركزه
- ❌ لا يمكن رؤية مراكز أخرى

### مدخل البيانات
- ✅ إدخال البيانات لمركزه فقط
- ✅ عرض البيانات التي أدخلها
- ❌ لا يمكن رؤية بيانات مراكز أخرى
- ❌ البيانات تحتاج موافقة المدير

## الملفات المهمة

### قاعدة البيانات
- `FINAL_COMPLETE_SYSTEM.sql` - الهيكل الأساسي والمراكز
- `FINAL_CENTER_MANAGERS.sql` - مديري المراكز
- `data_entry_users.sql` - مدخلي البيانات

### النظام
- `login.php` - صفحة تسجيل الدخول
- `dashboard.php` - لوحة التحكم الرئيسية
- `center_manager_dashboard.php` - لوحة مدير المركز
- `data_entry_dashboard.php` - لوحة مدخل البيانات

### الإعدادات
- `config/config.php` - إعدادات النظام
- `config/database.php` - إعدادات قاعدة البيانات
- `classes/User.php` - فئة إدارة المستخدمين

## ملاحظات مهمة

1. **الأمان:** جميع كلمات المرور مشفرة باستخدام `password_hash()`
2. **الجلسات:** نظام جلسات آمن مع انتهاء صلاحية
3. **الصلاحيات:** نظام صلاحيات متدرج ومحكم
4. **قاعدة البيانات:** استخدام PDO للحماية من SQL Injection
5. **التوجيه:** كل دور يتم توجيهه للوحة التحكم المناسبة

## استكشاف الأخطاء

### مشاكل قاعدة البيانات
- تأكد من تشغيل MySQL على المنفذ 3307
- تأكد من إنشاء قاعدة البيانات بالاسم الصحيح
- تأكد من صلاحيات المستخدم

### مشاكل تسجيل الدخول
- تأكد من تحديث ثوابت الأدوار في `config.php`
- تأكد من تحديث `User.php` ليشمل معلومات المركز والمستشفى

### مشاكل التوجيه
- تأكد من تحديث `login.php` للتوجيه الصحيح
- تأكد من وجود ملفات الداشبورد المطلوبة

## الدعم
لأي مشاكل أو استفسارات، يرجى مراجعة ملفات السجل في مجلد `logs/`
