<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>صفحة الاعتماد - نظام إدارة القوى العاملة الصحية</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="loading-text">صفحة الاعتماد</div>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">
                    <i class="fas fa-hospital"></i>
                </div>
                <div class="logo-text">
                    <h1>الصحة القابضة</h1>
                    <p>نظام إدارة القوى العاملة الصحية</p>
                </div>
            </div>
            <div class="header-info">
                <div class="hospital-info">
                    <i class="fas fa-building"></i>
                    <span id="hospital-name">مستشفى الملك فهد التخصصي</span>
                </div>
                <div class="center-info">
                    <i class="fas fa-users"></i>
                    <span id="center-name">مركز الطب الباطني</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-content">
            <a href="dashboard.html" class="nav-item">
                <i class="fas fa-home"></i>
                <span>الرئيسية</span>
            </a>
            <a href="data-entry.html" class="nav-item">
                <i class="fas fa-edit"></i>
                <span>إدخال البيانات</span>
            </a>
            <a href="approval.html" class="nav-item active">
                <i class="fas fa-check-circle"></i>
                <span>الاعتماد</span>
            </a>
            <a href="reports.html" class="nav-item">
                <i class="fas fa-chart-bar"></i>
                <span>التقارير</span>
            </a>
            <a href="users.html" class="nav-item">
                <i class="fas fa-users-cog"></i>
                <span>إدارة المستخدمين</span>
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page Header -->
        <div class="page-header">
            <h2 class="page-title">
                <i class="fas fa-check-circle"></i>
                صفحة الاعتماد
            </h2>
            <p class="page-subtitle">مراجعة واعتماد الطلبات المرسلة من المراكز</p>
        </div>

        <!-- Approval Statistics -->
        <div class="approval-stats">
            <div class="stat-card pending">
                <div class="stat-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-content">
                    <h3>في انتظار الاعتماد</h3>
                    <div class="stat-number" id="pending-count">15</div>
                </div>
            </div>
            <div class="stat-card approved">
                <div class="stat-icon">
                    <i class="fas fa-check"></i>
                </div>
                <div class="stat-content">
                    <h3>تم الاعتماد</h3>
                    <div class="stat-number" id="approved-count">42</div>
                </div>
            </div>
            <div class="stat-card rejected">
                <div class="stat-icon">
                    <i class="fas fa-times"></i>
                </div>
                <div class="stat-content">
                    <h3>تم الرفض</h3>
                    <div class="stat-number" id="rejected-count">8</div>
                </div>
            </div>
            <div class="stat-card total">
                <div class="stat-icon">
                    <i class="fas fa-list"></i>
                </div>
                <div class="stat-content">
                    <h3>إجمالي الطلبات</h3>
                    <div class="stat-number" id="total-count">65</div>
                </div>
            </div>
        </div>

        <!-- Filters and Search -->
        <div class="filters-section">
            <div class="filters-header">
                <h3>
                    <i class="fas fa-filter"></i>
                    فلترة الطلبات
                </h3>
                <button class="btn btn-secondary" onclick="clearFilters()">
                    <i class="fas fa-undo"></i>
                    مسح الفلاتر
                </button>
            </div>
            <div class="filters-grid">
                <div class="filter-group">
                    <label for="status-filter">الحالة</label>
                    <select id="status-filter" onchange="applyFilters()">
                        <option value="">جميع الحالات</option>
                        <option value="pending">في انتظار الاعتماد</option>
                        <option value="approved">معتمد</option>
                        <option value="rejected">مرفوض</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="type-filter">نوع الطلب</label>
                    <select id="type-filter" onchange="applyFilters()">
                        <option value="">جميع الأنواع</option>
                        <option value="leave">إجازة</option>
                        <option value="transfer">تنقل</option>
                        <option value="delegation">إيفاد</option>
                        <option value="assignment">تكليف</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="center-filter">المركز</label>
                    <select id="center-filter" onchange="applyFilters()">
                        <option value="">جميع المراكز</option>
                        <option value="1">مركز الطب الباطني</option>
                        <option value="2">مركز الطوارئ</option>
                        <option value="3">مركز الجراحة</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="date-from">من تاريخ</label>
                    <input type="date" id="date-from" onchange="applyFilters()">
                </div>
                <div class="filter-group">
                    <label for="date-to">إلى تاريخ</label>
                    <input type="date" id="date-to" onchange="applyFilters()">
                </div>
                <div class="filter-group">
                    <label for="search-input">البحث</label>
                    <input type="text" id="search-input" placeholder="ابحث عن الموظف أو رقم الطلب" onkeyup="applyFilters()">
                </div>
            </div>
        </div>

        <!-- Approval Actions -->
        <div class="approval-actions">
            <div class="bulk-actions">
                <button class="btn btn-success" onclick="bulkApprove()" disabled id="bulk-approve-btn">
                    <i class="fas fa-check-double"></i>
                    اعتماد المحدد
                </button>
                <button class="btn btn-danger" onclick="bulkReject()" disabled id="bulk-reject-btn">
                    <i class="fas fa-times"></i>
                    رفض المحدد
                </button>
                <span class="selected-count" id="selected-count">0 عنصر محدد</span>
            </div>
            <div class="view-actions">
                <button class="btn btn-info" onclick="exportApprovals()">
                    <i class="fas fa-download"></i>
                    تصدير
                </button>
                <button class="btn btn-secondary" onclick="refreshApprovals()">
                    <i class="fas fa-sync-alt"></i>
                    تحديث
                </button>
            </div>
        </div>

        <!-- Approvals Table -->
        <div class="approvals-table-container">
            <div class="table-header">
                <h3>
                    <i class="fas fa-list"></i>
                    قائمة الطلبات
                </h3>
                <div class="table-controls">
                    <select id="page-size" onchange="changePageSize()">
                        <option value="10">10 لكل صفحة</option>
                        <option value="25" selected>25 لكل صفحة</option>
                        <option value="50">50 لكل صفحة</option>
                        <option value="100">100 لكل صفحة</option>
                    </select>
                </div>
            </div>
            <div class="table-wrapper">
                <table class="approvals-table" id="approvals-table">
                    <thead>
                        <tr>
                            <th>
                                <input type="checkbox" id="select-all" onchange="toggleSelectAll()">
                            </th>
                            <th>رقم الطلب</th>
                            <th>الموظف</th>
                            <th>نوع الطلب</th>
                            <th>المركز</th>
                            <th>التاريخ</th>
                            <th>الحالة</th>
                            <th>الإجراءات</th>
                        </tr>
                    </thead>
                    <tbody id="approvals-tbody">
                        <!-- Dynamic content will be loaded here -->
                    </tbody>
                </table>
            </div>
            <div class="pagination" id="pagination">
                <!-- Pagination will be generated here -->
            </div>
        </div>
    </main>

    <!-- Approval Modal -->
    <div id="approval-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">مراجعة الطلب</h3>
                <button class="modal-close" onclick="closeApprovalModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="request-details" id="request-details">
                    <!-- Request details will be loaded here -->
                </div>
                <div class="approval-form">
                    <div class="form-group">
                        <label for="approval-comment">التعليق</label>
                        <textarea id="approval-comment" placeholder="أدخل تعليقك على الطلب..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-success" onclick="approveRequest()">
                            <i class="fas fa-check"></i>
                            اعتماد
                        </button>
                        <button class="btn btn-danger" onclick="rejectRequest()">
                            <i class="fas fa-times"></i>
                            رفض
                        </button>
                        <button class="btn btn-secondary" onclick="closeApprovalModal()">
                            <i class="fas fa-times"></i>
                            إلغاء
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notification" class="notification">
        <div class="notification-content">
            <i class="notification-icon"></i>
            <span class="notification-message"></span>
        </div>
    </div>

    <script src="approval.js"></script>
</body>
</html>
