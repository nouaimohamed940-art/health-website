# دليل إعداد النظام الكامل
# Complete System Setup Guide

## نظرة عامة
تم إنشاء نظام شامل لإدارة القوى العاملة الصحية يشمل:

### 📊 الهيكل التنظيمي
- **3 مستشفيات**
- **38 مركز** (13 + 13 + 12)
- **120 مستخدم** مقسمين حسب الأدوار

### 🏥 المستشفيات
1. **مجمع الملك عبد الله الطبي** - 13 مركز
2. **مستشفى رابغ** - 13 مركز
3. **مستشفى الملك فهد** - 12 مركز

### 👥 الحسابات والأدوار

#### 1. السوبر يوزر (3 حسابات)
- `super_admin_1` - المدير العام الأول
- `super_admin_2` - المدير العام الثاني  
- `super_admin_3` - المدير العام الثالث
- **الصلاحيات**: رؤية جميع المراكز والمستشفيات

#### 2. مديري المستشفيات (3 حسابات)
- `hospital_manager_kamc` - مدير مجمع الملك عبد الله الطبي
- `hospital_manager_rh` - مدير مستشفى رابغ
- `hospital_manager_kfh` - مدير مستشفى الملك فهد
- **الصلاحيات**: رؤية مراكز مستشفاهم فقط

#### 3. مديري المراكز (38 حساب)
**مجمع الملك عبد الله الطبي:**
- `center_manager_kamc_im` - مدير مركز الطب الباطني
- `center_manager_kamc_fm` - مدير مركز طب الأسرة
- `center_manager_kamc_ped` - مدير مركز الأطفال
- `center_manager_kamc_og` - مدير مركز النساء والولادة
- `center_manager_kamc_er` - مدير مركز الطوارئ
- `center_manager_kamc_icu` - مدير مركز العناية المركزة
- `center_manager_kamc_rad` - مدير مركز الأشعة
- `center_manager_kamc_lab` - مدير مركز المختبر
- `center_manager_kamc_pharm` - مدير مركز الصيدلة
- `center_manager_kamc_nurs` - مدير مركز التمريض
- `center_manager_kamc_or` - مدير مركز العمليات
- `center_manager_kamc_adm` - مدير مركز الإدارة
- `center_manager_kamc_cs` - مدير مركز خدمة العملاء

**مستشفى رابغ:**
- `center_manager_rh_im` - مدير مركز الطب الباطني
- `center_manager_rh_fm` - مدير مركز طب الأسرة
- `center_manager_rh_ped` - مدير مركز الأطفال
- `center_manager_rh_og` - مدير مركز النساء والولادة
- `center_manager_rh_er` - مدير مركز الطوارئ
- `center_manager_rh_icu` - مدير مركز العناية المركزة
- `center_manager_rh_rad` - مدير مركز الأشعة
- `center_manager_rh_lab` - مدير مركز المختبر
- `center_manager_rh_pharm` - مدير مركز الصيدلة
- `center_manager_rh_nurs` - مدير مركز التمريض
- `center_manager_rh_or` - مدير مركز العمليات
- `center_manager_rh_adm` - مدير مركز الإدارة
- `center_manager_rh_cs` - مدير مركز خدمة العملاء

**مستشفى الملك فهد:**
- `center_manager_kfh_im` - مدير مركز الطب الباطني
- `center_manager_kfh_fm` - مدير مركز طب الأسرة
- `center_manager_kfh_ped` - مدير مركز الأطفال
- `center_manager_kfh_og` - مدير مركز النساء والولادة
- `center_manager_kfh_er` - مدير مركز الطوارئ
- `center_manager_kfh_icu` - مدير مركز العناية المركزة
- `center_manager_kfh_rad` - مدير مركز الأشعة
- `center_manager_kfh_lab` - مدير مركز المختبر
- `center_manager_kfh_pharm` - مدير مركز الصيدلة
- `center_manager_kfh_nurs` - مدير مركز التمريض
- `center_manager_kfh_or` - مدير مركز العمليات
- `center_manager_kfh_adm` - مدير مركز الإدارة

#### 4. مدخلي البيانات (76 حساب - 2 لكل مركز)
**أمثلة:**
- `data_entry_kamc_im_1` - مدخل بيانات أول - الطب الباطني KAMC
- `data_entry_kamc_im_2` - مدخل بيانات ثاني - الطب الباطني KAMC
- `data_entry_rh_er_1` - مدخل بيانات أول - الطوارئ RH
- `data_entry_kfh_ped_2` - مدخل بيانات ثاني - الأطفال KFH

## 🔧 خطوات الإعداد

### 1. إنشاء قاعدة البيانات
```sql
-- تشغيل الملفات بالترتيب:
1. database_schema_simple.sql (الجداول الأساسية)
2. data_entry_tables.sql (جداول مدخلي البيانات)
3. center_manager_tables.sql (جداول مديري المراكز)
4. updated_complete_database.sql (البيانات الجديدة)
5. data_entry_users_complete.sql (مدخلي البيانات الكاملين)
```

### 2. تكوين قاعدة البيانات
```php
// في config/config.php
define('DB_HOST', 'localhost');
define('DB_PORT', '3307');
define('DB_NAME', 'health_staff_management');
define('DB_USER', 'root');
define('DB_PASS', '');
```

### 3. رفع الملفات
```
- جميع ملفات PHP في المجلد الجذر
- ملفات SQL للمرجع
- الصور والملفات الثابتة
```

## 🔐 نظام الصلاحيات

### السوبر يوزر
✅ رؤية جميع المراكز والمستشفيات  
✅ إدارة جميع المستخدمين  
✅ تصدير التقارير الشاملة  
✅ إعدادات النظام  

### مدير المستشفى
✅ رؤية مراكز مستشفاه فقط  
✅ مراجعة تقارير مراكزه  
✅ إدارة مديري المراكز التابعين  
❌ رؤية مستشفيات أخرى  

### مدير المركز
✅ رؤية بيانات مركزه فقط  
✅ موافقة طلبات مدخلي البيانات  
✅ إدارة موظفي مركزه  
✅ تصدير تقارير مركزه  
❌ رؤية مراكز أخرى  

### مدخل البيانات
✅ إدخال بيانات مركزه فقط  
✅ رؤية طلباته المرسلة  
❌ رؤية البيانات النهائية  
❌ رؤية مراكز أخرى  

## 📱 واجهات النظام

### 1. تسجيل الدخول
- **login.php** - تسجيل دخول المديرين والإداريين
- **data_entry_login.php** - تسجيل دخول مدخلي البيانات

### 2. لوحات التحكم
- **dashboard.php** - لوحة السوبر يوزر ومديري المستشفيات
- **center_manager_dashboard.php** - لوحة مديري المراكز
- **data_entry_dashboard.php** - لوحة مدخلي البيانات

### 3. إدخال البيانات
- **data_entry_workforce.php** - إدخال بيانات القوى العاملة
- **data_entry_transfers.php** - إدخال بيانات النقل والتكليف
- **data_entry_sick_leave.php** - إدخال الإجازات المرضية
- **data_entry_leaves.php** - إدخال الإجازات
- **data_entry_delegations.php** - إدخال الإيفاد والابتعاث

### 4. إدارة الطلبات
- **approval_requests.php** - موافقة مديري المراكز على الطلبات

## 🧪 الاختبار

### حسابات تجريبية للاختبار:

#### السوبر يوزر:
- `super_admin_1` / `password`

#### مديري المستشفيات:
- `hospital_manager_kamc` / `password`
- `hospital_manager_rh` / `password`
- `hospital_manager_kfh` / `password`

#### مديري المراكز:
- `center_manager_kamc_im` / `password`
- `center_manager_rh_er` / `password`
- `center_manager_kfh_ped` / `password`

#### مدخلي البيانات:
- `data_entry_kamc_im_1` / `password`
- `data_entry_rh_er_1` / `password`
- `data_entry_kfh_ped_2` / `password`

### سيناريوهات الاختبار:

1. **تسجيل دخول مدخل البيانات**
   - تسجيل دخول → إدخال بيانات → إرسال طلب

2. **موافقة مدير المركز**
   - تسجيل دخول مدير → مراجعة الطلبات → موافقة/رفض

3. **مراجعة مدير المستشفى**
   - تسجيل دخول → رؤية بيانات مراكزه فقط

4. **السوبر يوزر**
   - تسجيل دخول → رؤية جميع البيانات

## 🔒 الأمان

### تشفير البيانات
- جميع كلمات المرور مشفرة بـ `password_hash()`
- استخدام PDO مع Prepared Statements
- تسجيل جميع الأنشطة

### التحكم في الوصول
- كل مستخدم يرى بياناته فقط
- التحقق من الصلاحيات في كل صفحة
- منع SQL Injection و XSS

### تسجيل الأنشطة
- تسجيل دخول/خروج
- إدخال البيانات
- الموافقة/الرفض
- IP Address و User Agent

## 📈 التقارير

### مستويات التقارير
1. **مركز واحد** - مدير المركز
2. **مجموعة مراكز** - مدير المستشفى
3. **جميع المراكز** - السوبر يوزر

### أنواع التقارير
- يومية
- أسبوعية
- شهرية
- سنوية

### تصدير التقارير
- Excel
- PDF
- CSV

## 🛠️ الصيانة

### النسخ الاحتياطي
- نسخ احتياطي يومي لقاعدة البيانات
- نسخ احتياطي أسبوعي للملفات

### المراقبة
- مراقبة الأداء
- مراقبة الأخطاء
- مراقبة الأمان

### التحديثات
- تحديثات أمنية
- إضافة ميزات جديدة
- تحسين الأداء

---

## ✅ التحقق من الإعداد

للتأكد من صحة الإعداد:

1. ✅ إنشاء قاعدة البيانات بنجاح
2. ✅ تسجيل دخول جميع أنواع المستخدمين
3. ✅ إدخال البيانات من مدخلي البيانات
4. ✅ موافقة مديري المراكز على الطلبات
5. ✅ عرض البيانات حسب الصلاحيات
6. ✅ تصدير التقارير

النظام جاهز للاستخدام! 🚀
